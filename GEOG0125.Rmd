--- 
title: "GEOG0125:  Advanced Topics in Social and Geographic Data Science"
author: Justin van Dijk^[Department of Geography, https://www.mappingdutchman.com/] and Stephen Law^[Department of Geography, https://www.geog.ucl.ac.uk/people/academic-staff/stephen-law]
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
link-citations: yes
github-repo: "jtvandijk/GEOG0125"
description: "GEOG0125: Advanced Topics in Social and Geographic Data Science."
url: 'https\://jtvandijk.github.io/GEOG0125/'
---

# Welcome {-}

Placeholder


## Weekly topics {-}
## Moodle {-}
## Useful additional resources {-}
## Office hours {-}

<!--chapter:end:index.Rmd-->

# (PART\*) Introduction {-}

# Introduction 
The first week of Advanced Topics in Social and Geographic Data Science will introduce the module, why is it useful and what you will learn. You will be given a recap to the introduction to social and geographic data science specifically on the machine learning workflow. We will then give instructions to the reading group and the coursework assessment. This week’s practical component will focus on installing a new virtual environment for the module, accessing Jupyter Notebook locally and a recap on a typical machine learning workflow in Python. We will also get everyone familiar with Google Colab Web service. This week plays a formative role in providing you with the baseline knowledge for the module.

<div class="note">
**This week's material is available on [Moodle](https://moodle.ucl.ac.uk/course/view.php?id=23879).**
</div>

<!--chapter:end:01-week01.Rmd-->


# (PART\*) Inference {-}
# Statistical Inference and Causality

Placeholder


## Introduction {#intro-w09}
#### Video: Introduction W01 {-}
### Reading list {#reading-list-w01}
#### Core reading {-}
#### Supplementary reading {-}
### Technical Help session
## Statistical inference
## Causality
### What is causality?
### The problem with causality
#### Video: Panel Data Analysis {-}
### Fixed effects models
#### File download {-}
### Random effects models
## Take home message
## Attributions {#attributions_w02}

<!--chapter:end:02-week02.Rmd-->

# (PART\*) GeoAI {-}

# Introduction to Deep Learning
This week, we will introduce you to the topic of Deep Learning, its history and its uses in digital humanities, robotics, climate science, geography and social science. We will discuss the principles and algorithms of training and evaluating a deep neural network as an extension of a linear regression model. We will also present the strength and weakness of such techniques. The practical component of the week will allow you to practice and deep learning models, which are highly transferable skills in the future.

<div class="note">
**This week's material is available on [Moodle](https://moodle.ucl.ac.uk/course/view.php?id=23879).**
</div>

<!--chapter:end:03-week03.Rmd-->

# Keynote: Spatial Data Science
This week we will have a guest lecture from Miguel Alvarez Garcia @Carto on CartoFrame and Spatial Data Science. Miguel is a Data Scientist at CARTO and has experience in optimisation and machine learning. His current work focuses on solving problems with a strong geospatial component in various sectors such as logistics, utilities, retail, and environmental. 

<div class="note">
**Details on this guest lecture are available on [Moodle](https://moodle.ucl.ac.uk/course/view.php?id=23879).**
</div>

<!--chapter:end:04-week04.Rmd-->

# Convolutional Neural Networks
This week, we will introduce you to the topic of Convolutional Neural Network, a special case of Neural Network. In particular, we will describe the various CNN architecture and the useful technique of transfer learning. We will discuss the principles behind the different convolutional layers and activation functions. We will also give a case study on street frontage classification and object detection. The practical component of the week will allow you to practice running convolutional neural network models.

<div class="note">
**This week's material is available on [Moodle](https://moodle.ucl.ac.uk/course/view.php?id=23879).**
</div>

<!--chapter:end:05-week05.Rmd-->

# Spatial Data Science Applications
This week, we will introduce you the topic of applying deep neural networks for spatial data science applications. In particular we will describe the use of multi-modality data in machine learning. In particular we will describe the use of multi-modal data for socio-economic predictions for two different papers.

<div class="note">
**This week's material is available on [Moodle](https://moodle.ucl.ac.uk/course/view.php?id=23879).**
</div>

<!--chapter:end:06-week06.Rmd-->

# Spatial-Temporal Mobility Analysis

## Introduction {#intro-w07}
Against the background of unprecedented growth in private vehicle ownership and the entrenchment of the private car in everyday life, the past decades have seen a growing and ongoing academic and policy debate on how to encourage individuals to change to more sustainable ways of travelling. More recently, researchers have started to build on so-called location-aware technologies, exploring innovative methods to more accurately capture, visualise, and analyse individual spatiotemporal travel patterns: information that can be used to formulate strategies to accommodate the increasing demand for transport vis-à-vis growing environmental and societal concerns.

This week we will be looking at capturing mobility data with GPS, specifically we will look at how to obtain, clean, and interpret a GPS data set. We will further use two Machine Learning algorithms, specifically Support Vector Machines and tree-based methods, to classify labeled GPS data into *stay* and *move* points. This week is structured around three short videos as well as a tutorial in R with a 'hands-on' application of GPS data classification.

Let's get to it!

#### Video: Introduction W07 {-}
```{r 07-short-lecture-welcome, warnings=FALSE, message=FALSE, echo=FALSE}
library(vembedr)
embed_msstream('') %>% use_align('left')
```
[Lecture slides] [[Watch on MS stream]]()

```{r 07-settings, warnings=FALSE, message=FALSE, echo=FALSE}
# settings
options(max.print=30)
```

### Reading list {#reading-list-w07}
Please find the reading list for this week below.

#### Core reading {-}
- Bohte, W. and K. Maat. 2009. Deriving and validating trip purposes and travel modes for multi-day GPS-based travel surveys: A large-scale application in the Netherlands. *Transportation Research Part C: Emerging Technologies* 17(3): 285–297. [[Link]](https://doi.org/10.1016/j.trc.2008.11.004)
- Feng, T and H. Timmermans. 2016. Comparison of advanced imputation algorithms for detection of transportation mode and activity episode using GPS data. *Transportation Planning and Technology* 39(2): 180–194. [[Link]](https://doi.org/10.1080/03081060.2015.1127540)
- Nitsche, P. *et al.*. 2014. Supporting large- scale travel surveys with smartphones - a practical approach. *Transportation Research Part C: Emerging Technologies* 43: 212–221. [[Link]](https://doi.org/10.1016/j.trc.2013.11.005)

#### Supplementary reading {-}
- Van Dijk, J. 2018. Identifying activity-travel points from GPS-data with multiple moving windows. *Computers, Environment and Urban Systems* 70: 84-101. [[Link]](https://doi.org/10.1016/j.compenvurbsys.2018.02.004)
- Wolf, J. 2000. Using GPS data loggers to replace travel diaries in the collection of travel data. *Doctoral dissertation*. Atlanta, Georgia: Georgia Institute of Technology. [[Link]](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.126.3799&rep=rep1&type=pdf)

### Technical Help session
Every Thursday between 13h00-14h00 you can join the **Technical Help** session on Microsoft Teams. The session will be hosted by [Alfie](https://www.ucl.ac.uk/geospatial-analytics/people/alfie-long). He will be there for the whole hour to answer any question you have live in the meeting or any questions you have formulated beforehand. If you cannot make the meeting, feel free to post the issue you are having in the Technical Help channel on the GEOG0125 Team so that Alfie can help to find a solution. 

## GPS data
Mobility is a central aspect of everyday life. In its simplest form, human mobility refers to the movement of individuals from location **A** to location **B**. This can be a relocation from one city to another city, as well as a trip from home to work. Transport systems provide the physical nodes and linkages that facilitate this mobility. However, transport systems and road networks in many cities around the world are under pressure as a result of unparalleled growth in private vehicle ownership and increasingly complex and fragmented travel patterns. Particularly in urban areas, this is problematic because it leads to problems such as congestion, accidents, road decay, and reduced accessibility. As such, governments and researchers throughout the world have started to recognise the need to curtail demand for private road transport, and agree that:

>"Technological breakthroughs [alone] are not going to provide the silver bullet for the mitigation of climate change and energy security threats caused by the transport sector" ([Stradling and Anable, 2008: 195](https://www.wiley.com/en-gb/Transport+Geographies%3A+Mobilities%2C+Flows+and+Spaces-p-9781405153225))

The realisation that increasing road infrastructure and improvements in car technology are not sufficient to address the transport problems around the world has led to the idea that transport planning should shift from supply-side to demand-side passenger transport planning. For this, accurate dat are required on individual spatio-temporal behaviour.

Travel data collection methods can roughly be classified into two, not mutually exclusive, methods. The first method uses self-reported data, such as data collected through telephone-assisted interviews, computer-assisted interviews, and pen-and-paper interviews. The second method relies on passively collected data, such as data collected through call-detail records and GPS data. Technological developments in the field of location-aware technologies, GPS in particular, have greatly enhanced opportunities to collect accurate data on human spatiotemporal behaviour. GPS data need to be collected and analysed systematically to be intelligible for transport researchers and policy makers. Moreover, the challenges inherent to mobile data collection techniques include not only harnessing the tools to obtain geo-referenced data, but also the development of new skills sets for cleaning, analysing, and interpreting these data.

#### Video: GPS data  {-}
```{r 07-gps-data, warnings=FALSE, message=FALSE, echo=FALSE}
embed_msstream('') %>% use_align('left')
```
[[Lecture slides]]() [[Watch on MS stream]]()

## GPS data classification
Where GPS technology can precisely register the spatiotemporal elements of activity-travel behaviour, travel characteristics need to be imputed from the data. As such, throughout the last decade or so, a plethora of methods has been developed for identifying trips, activities, and travel modes from raw GPS trajectories. These methods range from deterministic (rule-based) methods to advanced machine learning algorithms. Here, we will focus on using two types of machine learning techniques (Support Vector Machines and tree-based methods) to classify labelled GPS points into *stay* and *move* points.

#### Video: GPS data classification {-}
```{r 04-data-classification, warnings=FALSE, message=FALSE, echo=FALSE}
embed_msstream('') %>% use_align('left')
```
[[Lecture slides]]() [[Watch on MS stream]]()

The segmentation of GPS data into activity and travel episodes is often the first step in a more elaborate process of identifying activity types and transport modes. A major issue with GPS data imputation, however, is the necessity of a ground truth to test whether the imputation algorithm correctly categorises GPS points into activity (*stay*) points and trips (*move*) points. We will be using a set of [100 artificially created GPS tracks](https://doi.org/10.1016/j.compenvurbsys.2018.02.004) that contain a sequence of stays and moves in Cape Town, South Africa. For the data that we will use, the artificial GPS 'records' a measurement every 60 seconds. To further simulate noise in the data, a random sample comprising of 50 per cent of the data points was taken. Besides these raw GPS data, we also have access to a basic road network lay out of the [Mother City](https://www.capetownmagazine.com/cape-town#:~:text=A%20more%20commonly%2Dused%20nickname,visitors%20to%20Cape%20Town%20alike.). 

#### File download {-}
| File                                                 | Type           | Link |
| :------                                              | :------        | :------ |
| Cape Town GPS and road data                          |`shp`     | [Download](https://github.com/jtvandijk/GEOG0125/tree/master/raw/zip/capetown.zip) |

We will start by downloading the files, importing both into R, and having a look at what we will be working with. Be careful *not* to plot the road network file. Because the road network contains around 120,000 individual road segments it will take a long time to draw. Rather have a look at the data in [QGIS](https://www.qgis.org/en/site/), which is much more capable of on the fly displaying a large number of features.

```{r 07-load-libraries, warnings=FALSE, message=FALSE, cache=TRUE}
# load libraries
library(tidyverse)
library(sf)
library(tmap)

# read gps data
gps <- read_sf('raw/w07/gps_cape_town.shp')

# read road data
road <- read_sf('raw/w07/roads_cape_town.shp')

# inspect
gps

# inspect
road

# inspect 
names(gps)
```

The road network file is relatively simple and only contains the road network segments - no additional information (e.g. maximum speed, road type, etc.) is available. The GPS data themselves contain several fields:

| Column heading | Description |
| :---           | :---------- |
| *stop*         | Stop number within GPS track |
| *type*         | Type of stop (i.e. short, medium, long) |
| *duration*     | Duration of stop in seconds |
| *point_id_n*   | Unique point identifier within GPS track |
| *timestamp*    | Time the point was recorded |
| *mode*         | Travel mode |
| *track_id*     | Unique ID for GPS track |
| *move*         | Whether point is a move or a stay |
| *activity*     | Whether point is move (inlcuding mode) or stay | 

The *move* variable is the variable we will try to predict. Before we split our data into a *train* and *test* set, however, we will need to derive some features that will serve as predictors: speed, point density, and distance to nearest road segment.

```{r 07-calculate-speed, warnings=FALSE, message=FALSE, cache=TRUE}
# calculate distance between consecutive points
gps <- gps %>% 
       group_by(track_id) %>%
       mutate(
        lead = geometry[row_number() + 1],
        dist = st_distance(geometry, lead, by_element = T)
       )

```

## Take home message

## Attributions {#attributions_w07}
This week's content and practical uses content and inspiration from:

- Van Dijk, J. 2017. Designing Travel Behaviour Change Interventions: a spatiotemporal perspective. *Doctoral dissertation*. Stellenbosch: Stellenbosch University.[[Link]](http://hdl .handle.net/10019.1/102809)
- Van Dijk, J. 2018. Identifying activity-travel points from GPS-data with multiple moving windows. *Computers, Environment and Urban Systems* 70: 84-101. [[Link]](https://doi.org/10.1016/j.compenvurbsys.2018.02.004)

<!--chapter:end:07-week07.Rmd-->

# (PART\*) Data Sciencist's Toolbox {-}

# Unix tools

## Introduction {#intro-w08}
This week we will be looking at the Unix tools. Basic knowledge of the Unix shell as well as knowing how to retrieve datasets from databases are essential tools in a data scientist’s toolkit. This week you will be introduced to both. In the practical component of this week you will work within the 'bourne again shell' (bash) in a command-line environment to create a parallel data processing pipeline involving a database and Unix tools.

<div class="note">
**This week’s content will be made available on 08/03/2021.**
</div>


<!--chapter:end:08-week08.Rmd-->

# Web Visualisation

## Introduction {#intro-w09}
Mapping is at the core of Spatial Data Science. This week we will introduce you to 'mapping at scale': how to display large amounts of data with interactive maps through slippy maps. In the practical component we will be using map tiles to create an interactive web map from scratch using `JavaScript` and `Leaflet.js`.

<div class="note">
**This week’s content will be made available on 15/03/2021.**
</div>

<!--chapter:end:09-week09.Rmd-->

# (PART\*) Future {-}

# A look into the future
This week we will wrap up what we have discussed over the past weeks and take a look at the future of Social and Geographic Data science.

<div class="note">
**This week's material will be available on [Moodle](https://moodle.ucl.ac.uk/course/view.php?id=23879).**
</div>

<!--chapter:end:10-week10.Rmd-->

